{% extends 'tasks/base.html' %} {% block content %} {% load static %}
<div class="header">
  <link rel="stylesheet" href="{% static 'tasks/css/task_analytics.css' %}" />
  <h1>
    <img
      src="{% static 'tasks/images/increase.png' %}"
      alt="Logo"
      style="width: 30px; height: 30px"
    />
    Feladat Elemz√©sek
  </h1>
  <a href="{% url 'task_list' %}" class="btn">‚Üê Vissza a feladatokhoz</a>
</div>
<!-- √ñsszefoglal√≥ k√°rty√°k -->
<div class="stats-grid">
  <div class="stat-card">
    <h3>
      <img
        src="{% static 'tasks/images/pencil.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      √ñsszes feladat
    </h3>
    <div class="value">{{ total_tasks }}</div>
    <div class="label">L√©trehozott feladatok</div>
  </div>

  <div
    class="stat-card"
    style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%)"
  >
    <h3>
      <img
        src="{% static 'tasks/images/check.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      Befejezett
    </h3>
    <div class="value">{{ completed_tasks }}</div>
    <div class="label">Teljes√≠tett feladatok</div>
  </div>

  <div
    class="stat-card"
    style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%)"
  >
    <h3>
      <img
        src="{% static 'tasks/images/sandclock.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      Folyamatban
    </h3>
    <div class="value">{{ pending_tasks }}</div>
    <div class="label">Akt√≠v feladatok</div>
  </div>
</div>

<!-- Line√°ris regresszi√≥s el≈ërejelz√©sek -->
<div class="analysis-section">
  <h2>Befejez√©si id≈ë el≈ërejelz√©sek (Line√°ris regresszi√≥)</h2>

  <div class="info-box">
    <h3>
      <img
        src="{% static 'tasks/images/letter.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      Hogyan m≈±k√∂dik?
    </h3>
    <p>
      A line√°ris regresszi√≥ matematikai modellt haszn√°l a m√∫ltbeli feladatok
      adatai alapj√°n. Az algoritmus elemzi, hogy a k√ºl√∂nb√∂z≈ë priorit√°s√∫
      feladatok √°tlagosan mennyi id≈ë alatt k√©sz√ºlnek el, √©s ezt felhaszn√°lva
      el≈ërejelzi az √∫j feladatok v√°rhat√≥ befejez√©si idej√©t.
    </p>
  </div>

  {% if predictions %}
  <div class="prediction-card high">
    <h3 style="color: #e74c3c; margin-bottom: 10px">
      <img
        src="{% static 'tasks/images/red.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      Magas priorit√°s√∫ feladat
    </h3>
    <p
      style="font-size: 24px; font-weight: bold; color: #2c3e50; margin: 10px 0"
    >
      {{ predictions.high.predicted_hours|floatformat:1 }} √≥ra
    </p>
    <p style="color: #7f8c8d">
      ‚âà {{ predictions.high.predicted_days|floatformat:1 }} nap
    </p>
  </div>

  <div class="prediction-card">
    <h3 style="color: #f39c12; margin-bottom: 10px">
      <img
        src="{% static 'tasks/images/yellow.png' %}"
        alt="Logo"
        style="width: 25px; height: 25px"
      />
      K√∂zepes priorit√°s√∫ feladat
    </h3>
    <p
      style="font-size: 24px; font-weight: bold; color: #2c3e50; margin: 10px 0"
    >
      {{ predictions.medium.predicted_hours|floatformat:1 }} √≥ra
    </p>
    <p style="color: #7f8c8d">
      ‚âà {{ predictions.medium.predicted_days|floatformat:1 }} nap
    </p>
  </div>

  <div class="prediction-card low">
    <h3 style="color: #95a5a6; margin-bottom: 10px">
      <img
        src="{% static 'tasks/images/white.png' %}"
        alt="Logo"
        style="width: 18px; height: 18px"
      />
      Alacsony priorit√°s√∫ feladat
    </h3>
    <p
      style="font-size: 24px; font-weight: bold; color: #2c3e50; margin: 10px 0"
    >
      {{ predictions.low.predicted_hours|floatformat:1 }} √≥ra
    </p>
    <p style="color: #7f8c8d">
      ‚âà {{ predictions.low.predicted_days|floatformat:1 }} nap
    </p>
  </div>
  {% else %}
  <div class="no-data">
    <p>‚ö†Ô∏è Nincs el√©g adat az el≈ërejelz√©shez. Fejezz be legal√°bb 2 feladatot!</p>
  </div>
  {% endif %}
</div>

<!-- St√°tusz eloszl√°s -->
{% if status_distribution %}
<div class="analysis-section">
  <h2>
    <img
      src="{% static 'tasks/images/increase.png' %}"
      alt="Logo"
      style="width: 30px; height: 30px"
    />
    Feladatok eloszl√°sa st√°tusz szerint
  </h2>
  <div class="chart-container">
    {% for status, data in status_distribution.items %}
    <div style="margin-bottom: 15px">
      <div
        style="
          display: flex;
          justify-content: space-between;
          margin-bottom: 5px;
        "
      >
        <span style="font-weight: bold">{{ status }}</span>
        <span>{{ data.count }} feladat ({{ data.percentage }}%)</span>
      </div>
      <div class="bar" style="width: {{ data.percentage }}%;">
        <span class="bar-label">{{ data.percentage }}%</span>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- Priorit√°s szerinti statisztik√°k -->
{% if priority_stats %}
<div class="analysis-section">
  <h2>
    <img
      src="{% static 'tasks/images/alarm.png' %}"
      alt="Logo"
      style="width: 30px; height: 30px"
    />
    Priorit√°s szerinti befejez√©si id≈ëk
  </h2>
  <table class="priority-table">
    <thead>
      <tr>
        <th>Priorit√°s</th>
        <th>Feladatok sz√°ma</th>
        <th>√Åtlag id≈ë</th>
        <th>Min id≈ë</th>
        <th>Max id≈ë</th>
      </tr>
    </thead>
    <tbody>
      {% for priority, stats in priority_stats.items %}
      <tr>
        <td style="font-weight: bold">{{ priority }}</td>
        <td>{{ stats.count }}</td>
        <td>{{ stats.avg_time|floatformat:1 }} √≥ra</td>
        <td>{{ stats.min_time|floatformat:1 }} √≥ra</td>
        <td>{{ stats.max_time|floatformat:1 }} √≥ra</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

<!-- Befejez√©si statisztik√°k -->
{% if completion_stats %}
<div class="analysis-section">
  <h2>üìà √Åltal√°nos befejez√©si statisztik√°k</h2>
  <div
    style="
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    "
  >
    <div style="background: white; padding: 15px; border-radius: 8px">
      <div style="color: #7f8c8d; font-size: 14px">√Åtlagos id≈ë</div>
      <div style="font-size: 24px; font-weight: bold; color: #667eea">
        {{ completion_stats.avg_completion_time|floatformat:1 }} √≥ra
      </div>
    </div>
    <div style="background: white; padding: 15px; border-radius: 8px">
      <div style="color: #7f8c8d; font-size: 14px">Medi√°n id≈ë</div>
      <div style="font-size: 24px; font-weight: bold; color: #667eea">
        {{ completion_stats.median_completion_time|floatformat:1 }} √≥ra
      </div>
    </div>
    <div style="background: white; padding: 15px; border-radius: 8px">
      <div style="color: #7f8c8d; font-size: 14px">Leggyorsabb</div>
      <div style="font-size: 24px; font-weight: bold; color: #27ae60">
        {{ completion_stats.min_completion_time|floatformat:1 }} √≥ra
      </div>
    </div>
    <div style="background: white; padding: 15px; border-radius: 8px">
      <div style="color: #7f8c8d; font-size: 14px">Leglassabb</div>
      <div style="font-size: 24px; font-weight: bold; color: #e74c3c">
        {{ completion_stats.max_completion_time|floatformat:1 }} √≥ra
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- Heti trend -->
{% if weekly_trend %}
<div class="analysis-section">
  <h2>
    <img
      src="{% static 'tasks/images/calendar.png' %}"
      alt="Logo"
      style="width: 30px; height: 30px"
    />
    Heti befejez√©si trend (utols√≥ 4 h√©t)
  </h2>
  <div class="chart-container">
    {% for week in weekly_trend %}
    <div style="margin-bottom: 15px">
      <div
        style="
          display: flex;
          justify-content: space-between;
          margin-bottom: 5px;
        "
      >
        <span style="font-weight: bold">{{ week.week }}</span>
        <span>{{ week.completed }} befejezett feladat</span>
      </div>
      <div
        class="bar"
        style="width: {{ week.completed|add:0 }}0%; max-width: 100%;"
      >
        <span class="bar-label">{{ week.completed }}</span>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %} {% if not completion_stats and not status_distribution %}
<div class="no-data">
  <h2>üì≠ Nincs el√©g adat az elemz√©shez</h2>
  <p>
    Hozz l√©tre √©s fejezz be n√©h√°ny feladatot, hogy l√°sd a statisztik√°kat √©s
    el≈ërejelz√©seket!
  </p>
  <a href="{% url 'task_create' %}" class="btn" style="margin-top: 20px"
    >+ √öj feladat l√©trehoz√°sa</a
  >
</div>
{% endif %} {% endblock %}
